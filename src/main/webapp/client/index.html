<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="pragram" content="no-cache"> 
<meta http-equiv="cache-control" content="no-cache, must-revalidate"> 
<meta http-equiv="expires" content="0"> 
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>中介宝房源软件系统</title>
<meta name="description" content="中介宝房源软件系统">
<meta name="keywords" content="房源软件,房源系统,中介宝">
<link href="/style/css.css" rel="stylesheet">
<link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
<link href="/style/style.css" rel="stylesheet">
<script src="/js/jquery.js" type="text/javascript"></script>
<script src="/bootstrap/js/bootstrap.js" type="text/javascript"></script>
<script src="/js/dialog/jquery.artDialog.source.js?skin=win8s" type="text/javascript"></script>
<script src="/js/dialog/plugins/iframeTools.source.js" type="text/javascript"></script>
<script src="/js/jquery.cookie.js" type="text/javascript"></script>
<script src="/js/jquery.timers.js" type="text/javascript"></script>
<script src="/js/jquery.input.js" type="text/javascript"></script>
<script src="/js/jquery.j.tool.js" type="text/javascript"></script>
<script type="text/javascript" src="/js/buildHtml.js"></script>
<script src="/js/jquery.SuperSlide.2.1.1.js" type="text/javascript"></script>
<script type="text/javascript" src="/js/pagination.js"></script>
<script type="text/javascript" src="/js/DatePicker/WdatePicker.js"></script>
<script type='text/javascript' src='/js/autocomplete/jquery.autocomplete.js'></script>
<script type="text/javascript">
var id;
var queryOptions;
var houseGJbox,/*houseSee / houseGJ 的*/
chuzu=getParam('chuzus');
var houseData;
var searching=false;
function doSearch(callback){
  if(searching){
    return;
  }
  searching=true;
  $('#searchBtn').attr('disabled','disabled');
  var a=$('form[name=form1]').serialize();
  YW.ajax({
    type: 'POST',
    url: '/c/client/list',
    data:a,
    mysuccess: function(data){
        houseData=JSON.parse(data);
        buildHtmlWithJsonArray("id_client_list",houseData['page']['data']);
        Page.setPageInfo(houseData['page']);
        setTableFix();
        if(callback){
          callback();
        }
        if(houseData['page']['data']<=0){
          $('.id_client_list').parents('.maxHW').addClass('list_noThing');
        }else{
         // $('.id_client_list').parents('.maxHW').removeClass('list_noThing');
        }
    },
    complete:function(){
      searching=false;
      $('#searchBtn').removeAttr('disabled');
    }
  });
}

function doSearchAndSelectFirst(){
  doSearch(function(){
    if(houseData.page.data.length>0){
      //$('.TableB').find('tr')[1].click();
      // getSider(houseData.page.data[0].id);
    }
  });
}
function getSider(id){
    if(id){
        $.get('/v/house/houseSee.html?id='+id, function(data) {
            var sideTop=parseInt(getSideH());
            $('#sideCont').html(data);
            $('#sideCont').css({top:sideTop});
            var sideHeadHeight=$('#sideCont').find('.sideHead').innerHeight()+3;
            $('#sideCont').css({'padding-top':sideHeadHeight});
            $('.sideHead').css({top:getHeadH()+sideTop+1});
        });
    }else{
    }
}

function getShenHeText(lock){
  if(lock==1){
    return "审";
  }else{
    return "未";
  }
}

function showAction(hcid,cid , seeGX){
  if(cid==1){
    return true;
  }else if(hcid==cid){
    if(seeGX==1){
      return false;
    }else{
      return true;
    }
  }else{
    return false;
  }
}

function shenheFy(id , obj){
  YW.ajax({
    type: 'POST',
    url: '/c/house/toggleShenHe?id='+id,
    mysuccess: function(data){
        var json = JSON.parse(data);
        if(json.sh==1){
          $(obj).text('审');
          $(obj).css('color','green');
        }else{
          $(obj).text('未');
          $(obj).css('color','red');
        }
    }
  });
}

function houseEdit(id){
  art.dialog.open("/house/house_edit.html?id="+id,{id:'seemap'})
}

function deletehouse(id){
  art.dialog.confirm('删除后不可恢复，确定要删除吗？', function () {
  YW.ajax({
    type: 'POST',
    url: '/c/house/physicalDelete?id='+id,
    mysuccess: function(data){
      doSearchAndSelectFirst();
      alert('删除成功');
    }
  });
  },function(){},'warning');
}

//文档按钮功能区
$(document).on('click', '.zbtns', function(event) {
    var Thi=$(this),
    ThiType=Thi.data('type');
    if(ThiType=='qingkong'){
//art.dialog.tips(window.location.pathname +'<br/>'+ window.location.href +'<br/>'+ window.location.port +'<br/>'+ window.location.protocol +'<br/>'+ window.location.hash +'<br/>'+ window.location.host +'<br/>'+ window.location.search,30);
        window.location.href=window.location.pathname+window.location.search;
    }else if(ThiType=='see'){
        this_hid=Thi.data('hid');
        art.dialog.open("/client/client_see.html?id="+this_hid,{id:'see',height:'90%',width:'95%'})
    }
});
$(document).ready(function() {
// 加载侧边
    
//添加提示框
    $(document).find('[data-toggle="tooltip"]').tooltip();
    $.get('/c/config/getQueryOptions', function(data) {
        queryOptions=JSON.parse(data);
        buildHtmlWithJsonArray("id_quyu",queryOptions['quyu'],true);
        buildHtmlWithJsonArray("id_lxing",queryOptions['lxing'],true);
        buildHtmlWithJsonArray("id_fxing",queryOptions['fxing'],true);
        buildHtmlWithJsonArray("id_zhuangxiu",queryOptions['zhuangxiu'],true);
        doSearchAndSelectFirst();
        Page.Init();
    });
   $.get('menuTop.html', function(data) {
       $('#menuTop').html(data);
   });
});
function form_menuSize(){
  var fBox=$('.form_menuSize'),
  fboxW=fBox.width(),
  fboxDiv=fBox.children('div'),
  btnZhe=fBox.find('.btn_zhe'),
  btnZt=fBox.find('.btn_zt'),
  btnZn=fBox.find('.btn_zn'),
  btnDh=fBox.find('.btn_dh'),
  btnQy=fBox.find('.btn_qy'),
  btnLx=fBox.find('.btn_lx'),
  btnFx=fBox.find('.btn_fx'),
  btnZh=fBox.find('.btn_zh'),
  btnSh;
  if (fBox.find('.btn_sh').length>0) {
    btnSh=fBox.find('.btn_sh');
  };
  btnZhe.css({'padding-right':'11px','padding-left':'10px'});
  btnZt.css({'padding-right':'10px','padding-left':'10px'});
  btnZn.css({'width':'265px'});
  btnDh.css({'width':'130px'});

  btnQy.css({'width':'63px'});
  btnLx.css({'width':'62px'});
  btnFx.css({'width':'63px'});
  btnZh.css({'width':'62px'});
    btnSh.css({'width':'50px','padding-right':'5px','padding-left':'5px'});
}
$(window).resize(function() {      //类别
});
$(document).ready(function() {
  form_menuSize();  
});
</script>
<style type="text/css">
  .selected{
    background-color: blue;
  }

.shenhe_0{color:red;}
.shenhe_1{color:green;}
.ztai_已售{color:red;}
.ztai_在售{color:blue;}
.ztai_停售{color:orange;}
</style>
</head>
<body>
<div class="html list">
    <div class="header">
        <div class="maxHW ">
            <ul class="menuLi clearfix titlebar" id="menuTop"></ul>
        </div>
  <form class="form-horizontal form1" onsubmit="doSearchAndSelectFirst();return false;" role="form" name="form1">
    <input type="hidden" id="sh" name="sh" value="$${sh}">
    <input type="hidden" class="hidden" name="pageInput" value="">
    <div class="form-group clearfix form_menuSize" style="background:#FFF; width:980px;">
      <div class="input-group">
        <span class="input-group-addon">姓名</span>
        <input type="text" class="form-control input-sm" name="search" autocomplete="off" placeholder="客户姓名">
      </div>
      <div class="input-group">
        <span class="input-group-addon">手机</span>
        <input type="text" class="form-control input-sm" name="search" autocomplete="off" placeholder="客户手机号" style="padding: 6px 4px;">
      </div>
      <div class="input-group input-group-max btn_zn ">
        <span class="input-group-addon">智能</span>
        <input type="text" class="form-control input-sm" name="search" id="searchs" autocomplete="off" placeholder="楼盘/路段/编号">
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn_qy btn btn-default dropdown-toggle" data-toggle="dropdown">
          区域<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li class="id_quyu"><label><input type="checkbox" name="quyus" value="${name}"> ${name}</label>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn_lx btn btn-default dropdown-toggle" data-toggle="dropdown">
          楼型<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" >
          <li class="id_lxing"><label><input type="checkbox" name="lxing" value="${name}" /> ${name}</label></li>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn_fx btn btn-default dropdown-toggle" data-toggle="dropdown">
          房型<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" >
          <li class="id_fxing"><label><input type="checkbox" name="fxing" value="${value}" /> ${name}</label></li>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn_zh btn btn-default dropdown-toggle" data-toggle="dropdown">
          装潢<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li class="id_zhuangxiu"><label><input type="checkbox" name="zxiu" value="${name}" /> ${name}</label></li>
        </ul>
      </div>
      <div auth="fy_sh" class="btn-group btn-sm">
        <button type="button" class="btn_sh btn btn-default dropdown-toggle" data-toggle="dropdown">
          审核<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li class="id_shenhe"><label><input type="radio" name="she" value="" onclick="$('#sh').val(this.value);doSearchAndSelectFirst();" checked /> 全部</label></li>
          <li class="id_shenhe"><label><input type="radio" name="she" value="1" onclick="$('#sh').val(this.value);doSearchAndSelectFirst();" /> 已审</label></li>
          <li class="id_shenhe"><label><input type="radio" name="she" value="0" onclick="$('#sh').val(this.value);doSearchAndSelectFirst();" /> 未审</label></li>
        </ul>
      </div>
    </div>

    <div class="form-group clearfix" style="line-height: 30px;">
      <div class="input-group">
        <span class="input-group-addon">面积</span>
        <input type="text" class="form-control input-sm" name="mjiStart">
        <input type="text" class="form-control input-sm" name="mjiEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">总价</span>
        <input type="text" class="form-control input-sm" name="zjiaStart">
        <input type="text" class="form-control input-sm" name="zjiaEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">单价</span>
        <input type="text" class="form-control input-sm" name="djiaStart">
        <input type="text" class="form-control input-sm" name="djiaEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">楼层</span>
        <input type="text" class="form-control input-sm" name="lcengStart">
        <input type="text" class="form-control input-sm" name="lcengEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">建筑<br/>年代</span>
        <input type="text" class="form-control input-sm" name="yearStart">
        <input type="text" class="form-control input-sm" name="yearEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon" style="padding:8px;">登记<br/>日期</span>
        <input type="text" class="form-control input-sm" name="dateStart" id="idTimes" onFocus="var timeend=$dp.$('idTime');WdatePicker({lang:'zh-cn',onpicked:function(){idTime.focus();},maxDate:'#F{$dp.$D(\'idTime\')}'})">
        <input type="text" class="form-control input-sm" name="dateEnd" id="idTime" onFocus="WdatePicker({lang:'zh-cn',minDate:'#F{$dp.$D(\'idTimes\')}'})">
      </div>
      <div class="btn-group">
        <button type="submit" class="btn btn-sms btn-primary btn_subnmit" id="searchBtn" data-type="submit">搜索</button>
      </div><br>
      <div class="btn-group">
        <button type="button" class="btn btn-sms zbtns" data-type="qingkong">清空</button>
      </div>
    </div>
  </form>
 
  <table class="table table-nopadding TableH  mainCont" >
    <tr>
      <th>编号</th>
      <th auth="fy_sh|fy_edit|fy_del">操作</th>
      <th>状态</th>
      <th>区域</th>
      <th>楼盘名称</th>
      <th>楼型</th>
      <th>户型</th>
      <th>面积</th>
      <th class="cs">总价(万)</th>
      <th class="cs">单价</th>
      <th>楼层</th>
      <th>装潢</th>
      <th class="sy">发布时间</th>
    </tr>
  </table>

    </div>
    <div class="bodyer mainCont">
  <div class="sideCont" id="sideCont"></div>
        <div class="maxHW" style="min-width: 700px;">

  <table class="table table-hover table-striped table-nopadding TableB" >
    <tbody>
    <tr data-hid="${id}" style="display:none;" class="id_client_list" >
      <td><span class="piliang hidden"><input type="checkbox" name="ids" value="${id}"> </span>${id}</td>
      <td style="width:80px;"  auth="fy_sh|fy_edit|fy_del">
        <a href="##" class="zbtns" data-hid="${id}" data-type="see">查看</a>
        <a href="##" auth="fy_sh" show="showAction(${cid},$${cid},${seeGX})" class="shenhe_${sh}" data-hid="${id}" runscript="true" data-rel="del" onclick="shenheFy(${id},this)">getShenHeText(${sh})</a>
        <a href="#" auth="fy_edit" show="showAction(${cid},$${cid},${seeGX})" class="edit" data-hid="${id}" onclick="houseEdit(${id})" data-rel="edit">改</a>
        <a href="##" auth="fy_del" show="showAction(${cid},$${cid},${seeGX})" class="del" data-hid="${id}" data-rel="del" onclick="deletehouse(${id})">删</a>
      </td>
      <td class="br_area">${name}</td>
      <td class="br_area">${tels}</td>
      <td class="br_area">${areas}</td>
      <td>${lxings}</td>
      <td>${hxings}</td>
      <td>${zxius}</td>
      <td>${quyus}</td>
      <td>${mjiFrom}-${mjiTo}</td>
      <td>${jiageFrom}-${jiageTo}</td>
      <td>${lcengFrom}-${lcengTo}</td>
      <td class="sy" runscript="true" title="${addtime}">'${addtime}'.split(' ')[0]</td>
    </tr>
    </tbody>
  </table>
        </div>
    </div>
    <div class="footer">
        <div class="maxHW mainCont ymx_page foot_page_box"></div>
    </div>
</div>
</body>
</html>