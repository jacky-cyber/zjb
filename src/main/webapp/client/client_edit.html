<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/js/buildHtml.js"></script>
<script src="/js/dialog/jquery.artDialog.source.js?skin=win8s" type="text/javascript"></script>
<script src="/js/dialog/plugins/iframeTools.source.js" type="text/javascript"></script>
<script type="text/javascript" src="/js/user.js"></script>
<script src="/js/jquery.j.tool.v2.js" type="text/javascript"></script>
<script type="text/javascript">
var lxingcont=0;
var hxingcont=0;
var zxiucont=0;
var quyucont=0;
var cid=$${cid};
var id;
function save(){
  if(checkTel()==false){
    return;
  }
  var a=$('form[name=form1]').serialize();
  YW.ajax({
    type: 'POST',
    url: '/c/client/update',
    data:a,
    mysuccess: function(data){
        // $('#saveBtn').removeAttr('disabled');
        art.dialog.close();
        art.dialog.opener.doSearch();
        alert('发布成功');
    }
  });
}

function close(){
  art.dialog.close();
}

function setSearchValue(index){
    var ThiA=$('#autoCompleteBox').find('a');
    ThiA.removeClass('hover');
    var Vals=ThiA.eq(index).addClass('hover').attr('area');
    $('#areas').val(Vals);
}

function getContent(){
  YW.ajax({
    type: 'get',
    url: '/c/client/get?id='+id,
    data:'',
    mysuccess: function(result){
      var json = JSON.parse(result);
      $('#id').val(json['id']);
      $('#name').val(json['name']);
      $('#tel').val(json['tels']);
      $('#lcengFrom').val(json['lcengFrom']);
      $('#lcengTo').val(json['lcengTo']);
      $('#areas').val(json['areas']);
      $('#mjiFrom').val(json['mjiFrom']);
      $('#mjiTo').val(json['mjiTo']);
      $('#jiageFrom').val(json['jiageFrom']);
      $('#jiageTo').val(json['jiageTo']);
      $('#djiaFrom').val(json['djiaFrom']);
      $('#djiaTo').val(json['djiaTo']);
      $('#yearFrom').val(json['yearFrom']);
      $('#yearTo').val(json['yearTo']);
      $('#beizhu').val(json['beizhu']);
      chaifen(json['lxings']);
      chaifen(json['zxius']);
      chaifen(json['hxings']);
      chaifen(json['quyus']);
      $('#djrDid').val(json['did']);
      $('#djrId').val(json['uid']);
    }
  });
}

function chaifen(val,name){
  if (val==null) {
    return;
  }else{
    var row = val.split(',');
    for (var i = 0; i < row.length ; i++) {
      var value = row[i];
      $('input[value="'+value+'"]').attr('checked','checked');
    }
  }
}

function jianCe(a){
  var count = 0;
  $('input[name="'+a.name+'"]').each(function(i,obj){
  if(obj.checked){
    count++;
    }
  });
  if (count>3) {
    a.checked=false;
    alert('最多只能选择三项');
  };
}

$(document).ready(function() {
  id = getParam('id');
  // autoComplete($('#search'));
  $.get('/c/config/getQueryOptions', function(data) {
    queryOptions=JSON.parse(data);
    buildHtmlWithJsonArray("id_lxing",queryOptions['lxing'],true);
    buildHtmlWithJsonArray("id_zxiu",queryOptions['zhuangxiu'],true);
    buildHtmlWithJsonArray("id_hxing",queryOptions['fxing'],true);
    buildHtmlWithJsonArray("id_quyu",queryOptions['quyu'],true);
    getContent();
  autoComplete($('#areas'));
  });
});
</script>
<link rel="stylesheet" type="text/css" href="/style/css_ky.css" />
</head>

<body>

<script>
   $(document).keypress(function(e) { 
       if(e.which == 13) {
        e.preventDefault();
          // jQuery(".confirmButton").click(); 
       } 
   }); 
</script>
<form name="form1" role="form">
<input type="hidden" name="id" id="id"/>
<table width="100%" border="0" cellspacing="0" cellpadding="0" class="layerTable1 TableBgColor1" style=" border-top:4px solid #e9e9e9;">

  <tr>
    <td width="80" align="right" class="TableTdBorBot TableTdBorTop">姓名：</td>
    <td width="318" class="TableTdBgColor"><input type="text" class="w1" id="name" name="name" desc="客户姓名"/></td>
    <td width="80" align="right" class="TableTdBorBot TableTdBorTop">电话：</td>
    <td width="318" class="TableTdBgColor"><input type="text" class="w1" id="tel" name="tels" placeholder="房主号码 / 分割" onblur="checkTel();"  /><span></span></td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">楼盘：</td>
    <td class="TableTdBgColor"><input type="text" class="w1" id="areas" name="areas"/></td>
    <td align="right" class="TableTdBorBot">楼层：</td>
    <td class="TableTdBgColor"><input type="text" class="w2" id="lcengFrom" desc="楼层" name="lcengFrom" />-<input type="text" desc="楼层" class="w2" id="lcengTo" name="lcengTo" /> 层</td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">楼型：</td>
    <td class="TableTdBgColor">
        <div class="id_lxing"><input type="checkbox" value="${name}" id="lxings" name="lxings" onclick="jianCe(this);" />${name}</div>
    </td>
    <td align="right" class="TableTdBorBot">装潢：</td>
    <td class="TableTdBgColor">
        <div class="id_zxiu"><input type="checkbox" value="${name}" name="zxius" id="zxius" onclick="jianCe(this);"/>${name}</div>
    </td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">户型：</td>
    <td class="TableTdBgColor">
        <div class="id_hxing"><input type="checkbox" value="${name}" name="hxings" id="hxings" onclick="jianCe(this);"/>${name}</div>
    </td>
    <td align="right" class="TableTdBorBot">区域：</td>
    <td class="TableTdBgColor">
        <div class="id_quyu"><input type="checkbox" value="${name}" name="quyus" id="quyus" onclick="jianCe(this);"/>${name}</div>
    </td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">面积：</td>
    <td class="TableTdBgColor"><input type="text" class="w2" desc="面积" id="mjiFrom" name="mjiFrom" />-<input type="text" desc="面积" class="w2" id="mjiTo" name="mjiTo"/> ㎡</td>
    <td align="right" class="TableTdBorBot">价格：</td>
    <td class="TableTdBgColor"><input type="text" class="w2" desc="价格" id="jiageFrom" name="jiageFrom" />-<input type="text" class="w2" desc="价格" id="jiageTo" name="jiageTo"/> 万</td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">单价：</td>
    <td class="TableTdBgColor"><input type="text" class="w2" desc="单价" id="djiaFrom" name="djiaFrom" />-<input type="text" desc="单价" class="w2" id="djiaTo" name="djiaTo"/></td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">年代：</td>
    <td class="TableTdBgColor"><input type="text" class="w2" id="yearFrom" desc="年代" name="yearFrom" />-<input type="text" class="w2" desc="年代" id="yearTo" name="yearTo"/></td>
    <td align="right" class="TableTdBorBot">业务员：</td>
    <td colspan="3" class="TableTdBgColor">
        <select name="did" id="djrDid" class="input-sm input-rightB w3 dept_select">
	    </select>
	    <select name="uid" id="djrId" class="input-sm input-left w3 user_select">
        </select>
    </td>
  </tr>
  <tr>
    <td align="right" class="TableTdBorBot">备注：</td>
    <td colspan="3" class="TableTdBgColor">
       <textarea class="TA" name="beizhu" id="beizhu"></textarea>
    </td>
  </tr>
  <tr>
    <td align="right" class="" style=" background-color:#e9e9e9;"> </td>
    <td colspan="3" class="" height="50" style=" background-color:#e9e9e9;">
       <button onclick="save();return false;" class="save btn btn-primary btn-block" >保存</button><button class="cancel" onclick="close();">取消</button>
    </td>
  </tr>
  
</table>
</form>
</body>
</html>
