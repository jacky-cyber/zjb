
<script type="text/javascript">
var rMenu;
var id;
  var setting = {
    view: {
      showIcon: false,
      addDiyDom: addDiyDom,
      showLine:false,
      dblClickExpand: false,
    },
    data: {
      simpleData: {
        enable: true
      }
    },
    callback: {
      onClick: onClick
    }
   };

YW.ajax({
  type: 'POST',
  url: '/c/dept/getDeptTree?cid=$${cid}',
  data:'',
  mysuccess: function(data){
      var result=JSON.parse(data);
      $.fn.zTree.init($("#treeDemo"), setting, result.result);
      rMenu = $("#rMenu");
  }
});

function addDiyDom(treeId, treeNode) {
  $("#" + treeNode.tId + "_ico").remove();
  // $("#" + treeNode.tId).css('display','inline');
  var aObj = $("#" + treeNode.tId + "_a");
  aObj.css('display','inline');
  if(treeNode.cnum!=null){
    var cnumStr = "<span>"+ treeNode.cnum +" </span>";
    aObj.prepend(cnumStr);  
  }
  // var color="";
  // if(treeNode.sh==0){
  //   color="red";
  // }
  // if(treeNode.type!="group"){
  //   var lockStr = "<i style='float:right;font-size:14px;color:"+color+"' class='icon iconfont'>&#xe64e;</i>";
  //   aObj.append(lockStr);
  // }
}

function onClick(event, treeId, treeNode, clickFlag) {
  console.log(treeNode);
  if(clickFlag!=null){
    var treeObj = $.fn.zTree.getZTreeObj(treeId);
    treeObj.expandNode(treeNode);
  }
  $('#cid').val("");
  $('#did').val("");
  if(treeNode.type=="comp"){
    $('#cid').val(treeNode.id);
  }else if(treeNode.type=="dept"){
    $('#did').val(treeNode.id);
  }else{
    return;
  }
  doSearch();
} 

</script>

<div class="sideHead">
    分公司列表
</div>

<table class="table table-nopadding side_table" width="100%">
  <tbody>
    <tr class="list">
      <td>
        <div class="zTreeDemoBackground left right">
          <ul id="treeDemo" class="ztree jtree"></ul>
        </div>
      </td>
    </tr>
  </tbody>
</table>

<div class="sideFoot">
  <ul>
    <li>
      
    </li>
  </ul>
</div>
