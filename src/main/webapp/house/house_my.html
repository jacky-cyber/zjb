<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="pragram" content="no-cache"> 
<meta http-equiv="cache-control" content="no-cache, must-revalidate"> 
<meta http-equiv="expires" content="0"> 
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>中介宝房源软件系统</title>
<meta name="description" content="中介宝房源软件系统">
<meta name="keywords" content="房源软件,房源系统,中介宝">
<link href="/style/css.css" rel="stylesheet">
<link href="/bootstrap/css/bootstrap.css" rel="stylesheet">
<link href="/style/style.css" rel="stylesheet">
<script src="/js/jquery.js" type="text/javascript"></script>
<script src="/bootstrap/js/bootstrap.js" type="text/javascript"></script>
<script src="/js/dialog/jquery.artDialog.source.js?skin=win8s" type="text/javascript"></script>
<script src="/js/dialog/plugins/iframeTools.source.js" type="text/javascript"></script>
<script src="/js/jquery.cookie.js" type="text/javascript"></script>
<script src="/js/jquery.timers.js" type="text/javascript"></script>
<script src="/js/jquery.input.js" type="text/javascript"></script>
<script src="/js/jquery.j.tool.js" type="text/javascript"></script>
<script type="text/javascript" src="/js/buildHtml.js"></script>
<script src="/js/jquery.SuperSlide.2.1.1.js" type="text/javascript"></script>
<script type="text/javascript" src="/js/pagination.js"></script>
<script type="text/javascript" src="/js/DatePicker/WdatePicker.js"></script>
<script type="text/javascript">
var queryOptions;
var houseData;
var houseGJbox,/*houseSee / houseGJ 的*/
chuzu=getParam('chuzus'),
flags=getParam('flag'),
URL_ajax_house_list;
if(flags=='favShou'){
    URL_ajax_house_list='/c/house/listMyFav'
}else if(flags=='addShou'){
    URL_ajax_house_list='/c/house/listMyAdd'
}else if(flags=='favZu'){
    URL_ajax_house_list='/c/house/rent/listMyFav'
}else if(flags=='addZu'){
    URL_ajax_house_list='/c/house/rent/listMyAdd'
}
function doSearch(callback){
  var a=$('form[name=form1]').serialize();
  YW.ajax({
    type: 'POST',
    url: URL_ajax_house_list,
    data:a,
    mysuccess: function(data){
        houseData=JSON.parse(data);
        buildHtmlWithJsonArray("id_House_list",houseData['page']['data']);
        Page.setPageInfo(houseData['page']);
        setTableFix();
        if(callback){
          callback();
        }
    }
  });
}

function getSider(id){
  var url = "";
  if(flags=='favZu' || flags=='addZu'){
    url = '/v/house/houseSee_rent.html?id='+id;
    // $('div.chushou').remove();
    if(flags=='addZu'){
      $('td.shc').remove();
      $('th.shc').remove();
    }
  }else{
    url = '/v/house/houseSee.html?id='+id;
    // $('div.chuzu').remove();
    if(flags=='addShou'){
      $('td.shc').remove();
      $('th.shc').remove();
    }
  }
  if(id){
    $.get(url, function(data) {
        var sideTop=parseInt(getSideH());
        $('#sideCont').html(data);
        $('#sideCont').css({top:sideTop});
        var sideHeadHeight=$('#sideCont').find('.sideHead').innerHeight()+3;
        $('#sideCont').css({'padding-top':sideHeadHeight});
        $('.sideHead').css({top:getHeadH()+sideTop+1});
    });
  }

}

function sideBtnFun(){

    $('.sideCont').on('click', '.btns', function(event) {
        event.preventDefault();
        /* Act on the event */
        var Thi=$(this),
        ThiType=Thi.data('type');
        if(ThiType=='add_company'){
        }
        return false;
    });
    $('.sideCont').on('click', '.btns', function(event) {
        var Thi=$(this),
        ThiHid=Thi.data('hid'),
        ThiType=Thi.data('type');
        if(ThiType=='addGenjin'){
            if(houseGJbox)houseGJbox.close();
            houseGJbox=art.dialog({
                follow: document.getElementById('addGenjinBtn'),
                content: '加载中...',
                title:'添加跟进',
                left:20,
                id:'houseGenjinBox',
                width:'250px',
                padding:'0'
            });
            // jQuery ajax   
            YW.ajax({
                url: '/v/house/house_genjin_add.html',
                mysuccess: function (data) {
                    houseGJbox.content(data);
                },
                cache: false
            });
        }else if(ThiType=='fav'){
            var ThiIsFav=Thi.attr('fav'),
            url,param={
                houseId:$('#dimHouseId').text(),
                chuzu:chuzu
            }
            if(ThiIsFav==1){
                if (flags=='favShou'){
                  url='addSell';
                }else{
                  url='addRent';
                }
                alertStr="收藏成功";
                dimStr='<i class="iconfont">&#xe62e;</i> 已收藏';
                Thi.attr('fav',0).attr('title','已收藏');
            }else{
                if (flags=='favShou'){
                  url='deleteSell';
                }else{
                  url='deleteRent';
                }
                alertStr="已取消收藏";
                dimStr='<i class="iconfont">&#xe648;</i> 收藏';
                Thi.attr('fav',1).attr('title','点此收藏');
            }
            YW.ajax({
                type: 'POST',
                url: '/c/house/fav/'+url,
                data:param,
                mysuccess: function(data){
                    //var json = JSON.parse(data);
                    alert(alertStr);
                    Thi.html(dimStr);
                },complete:function(){
                    
                }
            });
        }else if(ThiType=='map'){
            art.dialog.open('/house/house_see_map.html',{id:'seemap',height:400,width:900});
        }else if(ThiType=='copy'){
            alert('不给复制');
        }else{
            return false;
        }
    });
}

function favDelete(houseId){
  if (flags=='favShou') {
  YW.ajax({
    type: 'POST',
    url: '/c/house/fav/deleteSell?houseId='+houseId,
    mysuccess: function(data){
      doSearchAndSelectFirst();
    alert('已取消收藏');
  },complete:function(){}
});
}else{
  YW.ajax({
    type: 'POST',
    url: '/c/house/fav/deleteRent?houseId='+houseId,
    mysuccess: function(data){
      doSearchAndSelectFirst();
    alert('已取消收藏');
  },complete:function(){}
});
}
}

function doSearchAndSelectFirst(){
  doSearch(function(){
    if(houseData.page.data.length>0){
      getSider(houseData.page.data[0].id);
    }
  });
}
//文档按钮功能区
$(document).on('click', '.zbtns', function(event) {
    var Thi=$(this),
    ThiType=Thi.data('type');
    if(ThiType=='qingkong'){
        window.location.href=window.location.pathname+window.location.search;
    }
});
// autocomplete 必加
function setSearchValue(index){
    var ThiA=$('#autoCompleteBox').find('a');
    ThiA.removeClass('hover');
    var Vals=ThiA.eq(index).addClass('hover').attr('title');
    $('#search').val(Vals);
}
$(document).ready(function() {
// autocomplete
    autoComplete($('#search'))
// 加载侧边按钮功能
    sideBtnFun();
//添加提示框
    if (flags=='favZu' ||flags=='addZu') {
      $('div.chushou').remove();
    }else {
      $('div.chuzu').remove();
    }
    $(document).find('[data-toggle="tooltip"]').tooltip();
    $.get('/c/config/getQueryOptions', function(data) {
        queryOptions=JSON.parse(data);
        buildHtmlWithJsonArray("id_lxing",queryOptions['lxing'],true);
        buildHtmlWithJsonArray("id_fxing",queryOptions['fxing'],true);
        buildHtmlWithJsonArray("id_zhuangxiu",queryOptions['zhuangxiu'],true);
        buildHtmlWithJsonArray("id_quyu",queryOptions['quyu'],true);
        if(flags=='favZu' || flags=='addZu'){
            buildHtmlWithJsonArray("id_zhuangtai",queryOptions['ztai_rent'],true, true);
            buildHtmlWithJsonArray("id_fangshi",queryOptions['rent_type'],true , true);
        }else{
            buildHtmlWithJsonArray("id_zhuangtai",queryOptions['ztai_sell'],true, true);
        }
        Page.Init();
        doSearchAndSelectFirst();
    });
    $('.id_House_list').on('click', 'a', function(event) {
        var Thi=$(this),
        rel=Thi.data('rel'),
        this_hid=Thi.data('hid');
    });
    $('.TableB').on('click', 'tr', function(event) {
        var Thi=$(this),
        ThiHid=Thi.data('hid');
        if(houseGJbox)houseGJbox.close();
        getSider(ThiHid);
        // Thi.toggleClass('selected');
        return false;
    });
    $.get('menuTop.html', function(data) {
        $('#menuTop').html(data);
    });
});
$(window).resize(function() {      //类别
});
</script>
<style type="text/css">
  .selected{
    background-color: blue;
  }
</style>
</head>
<body>
<div class="html list title addSide">
    <div class="header">
        <div class="maxHW title">
            <ul class="menuLi clearfix title" id="menuTop"></ul>
        </div>
  <form class="form-horizontal form1" onsubmit="doSearch();return false;" role="form" name="form1">
    <input type="hidden" class="userInput" name="xpath" value="">
    <input type="hidden" class="hidden" name="pageInput" value="">
    <div class="form-group clearfix" style="background:#FFF; width:980px;">
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="padding-right: 11px;padding-left: 10px;">
          综合 <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><label><input type="radio" name="zonghe" value="1" checked> 所有</label>
          <li><label><input type="radio" name="zonghe" value="3"> 公司</label>
          <li><label><input type="radio" name="zonghe" value="7"> 共享</label>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  style="padding-right: 10px;padding-left: 10px;">
          状态 <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><label><input type="radio" name="ztai" value="" checked> 所有</label>
          <li class="id_zhuangtai"><label><input type="radio" name="ztai" value="${code}"> ${name}</label>
        </ul>
      </div>
      <div class="input-group input-group-max" style="width: 265px;">
        <span class="input-group-addon">智能</span>
        <input type="text" class="form-control input-sm" name="search" id="search" autocomplete="off" placeholder="楼盘/路段/电话/编号">
      </div>
      <div class="input-group input-group-too chushou" style="width:130px;">
        <input type="text" class="form-control input-sm" name="dhao" placeholder="栋号">
        <span class="input-group-addon">-</span>
        <input type="text" class="form-control input-sm" name="fhao" placeholder="房号">
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="width:77px;">
          区域<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li class="id_quyu"><label><input type="checkbox" name="quyus" value="${name}"> ${name}</label>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="width:76px;">
          楼型<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" >
          <li class="id_lxing"><label><input type="checkbox" name="lxing" value="${name}" /> ${name}</label></li>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="width:76px;">
          房型<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu" >
          <li class="id_fxing"><label><input type="checkbox" name="fxing" value="${value}" /> ${name}</label></li>
        </ul>
      </div>
      <div class="btn-group btn-sm">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" style="width:76px;">
          装潢<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li class="id_zhuangxiu"><label><input type="checkbox" name="zxiu" value="${name}" /> ${name}</label></li>
        </ul>
      </div>
      <div class="btn-group btn-sm chuzu">
        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"  style="padding-right: 11px;padding-left: 11px;">
          方式<span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><label><input type="radio" name="fangshi" value="" checked="checked" /> 不限</label></li>
          <li class="id_fangshi" style="display:none"><label><input type="radio" name="fangshi" value="${code}" /> ${name}</label></li>
        </ul>
      </div>
    </div>

    <div class="form-group clearfix" style="line-height: 30px;">
      <div class="input-group">
        <span class="input-group-addon">面积</span>
        <input type="text" class="form-control input-sm" name="mjiStart">
        <input type="text" class="form-control input-sm" name="mjiEnd">
      </div>
      <div class="input-group chushou">
        <span class="input-group-addon">总价</span>
        <input type="text" class="form-control input-sm" name="zjiaStart">
        <input type="text" class="form-control input-sm" name="zjiaEnd">
      </div>
      <div class="input-group chushou">
        <span class="input-group-addon">单价</span>
        <input type="text" class="form-control input-sm" name="djiaStart">
        <input type="text" class="form-control input-sm" name="djiaEnd">
      </div>
      <div class="input-group chuzu">
        <span class="input-group-addon">租金</span>
        <input type="text" class="form-control input-sm" name="zjiaStart">
        <input type="text" class="form-control input-sm" name="zjiaEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">楼层</span>
        <input type="text" class="form-control input-sm" name="lcengStart">
        <input type="text" class="form-control input-sm" name="lcengEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon">建筑<br/>年代</span>
        <input type="text" class="form-control input-sm" name="yearStart">
        <input type="text" class="form-control input-sm" name="yearEnd">
      </div>
      <div class="input-group">
        <span class="input-group-addon" style="padding:8px;">发布<br/>日期</span>
        <input type="text" class="form-control input-sm" name="dateStart" id="idTimes" onFocus="var timeend=$dp.$('idTime');WdatePicker({onpicked:function(){idTime.focus();},maxDate:'#F{$dp.$D(\'idTime\')}'})">
        <input type="text" class="form-control input-sm" name="dateEnd" id="idTime" onFocus="WdatePicker({minDate:'#F{$dp.$D(\'idTimes\')}'})">
      </div>
      <div class="btn-group">
        <button type="submit" class="btn btn-sms btn-primary btn_subnmit">搜索</button>
      </div><br>
      <div class="btn-group">
        <button type="button" class="btn btn-sms zbtns" data-type="qingkong">清空</button>
      </div>
    </div>
  </form>
 
  <table class="table table-nopadding TableH  mainCont" >
    <tr>
      <th>编号</th>
      <th class="shc">操作</th>
      <th>状态</th>
      <th>区域</th>
      <th>楼盘名称</th>
      <th>楼型</th>
      <th>户型</th>
      <th>面积</th>
      <th class="cs">总价(万)</th>
      <th class="cs">单价</th>
      <th>楼层</th>
      <th>装潢</th>
      <th class="sy">发布时间</th>
    </tr>
  </table>

    </div>
    <div class="bodyer mainCont">
  <div class="sideCont" id="sideCont"></div>
        <div class="maxHW" style="min-width: 700px;">

  <table class="table table-hover table-striped table-nopadding TableB" >
    <tbody>
    <tr data-hid="${id}" style="display:none;" class="id_House_list" >
      <td><span class="piliang hidden"><input type="checkbox" name="ids" value="${id}"> </span>${id}</td>
      <td class="shc">
        <a href="javascript.void(0)" class="delete" data-hid="${id}" data-rel="del" onclick="favDelete(${id});">取消收藏</a>
      </td>
      <td>${ztai}</td>
      <td>${quyu}</td>
      <td>${area} ${dhao}-${fhao}</td>
      <td>${lxing}</td>
      <td>${hxf}-${hxt}-${hxw}</td>
      <td>${mji}</td>
      <td>${zjia}</td>
      <td class="cs">${djia}</td>
      <td>${lceng}/${zceng}</td>
      <td>${zxiu}</td>
      <td class="sy">${dateadd}</td>
    </tr>
    </tbody>
  </table>
        </div>
    </div>
    <div class="footer">
        <div class="maxHW mainCont ymx_page foot_page_box"></div>
    </div>
</div>
</body>
</html>